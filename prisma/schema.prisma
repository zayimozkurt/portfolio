generator client {
    provider      = "prisma-client-js"
    binaryTargets = ["native", "linux-musl", "rhel-openssl-3.0.x"]
    output        = "../src/generated/client"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model User {
    id String @id @default(uuid())

    email        String
    userName     String  @unique
    passwordHash String
    fullName     String
    headline     String?
    bio          String?
    about        String?
    location     String?
    cvUrl        String?

    userImages     UserImage[]
    contacts       Contact[]
    skills         Skill[]
    experiences    Experience[]
    educations     Education[]
    portfolioItems PortfolioItem[]
}

model Skill {
    id     String @id @default(uuid())
    user   User   @relation(fields: [userId], references: [id])
    userId String

    name    String
    order   Int
    content Json?

    experiences    Experience[]
    educations     Education[]
    portfolioItems PortfolioItem[]

    @@unique([userId, name])
}

model UserImage {
    id     String @id @default(uuid())
    user   User   @relation(fields: [userId], references: [id])
    userId String

    url   String
    place String

    @@unique([userId, place])
}

model Contact {
    id     String @id @default(uuid())
    user   User   @relation(fields: [userId], references: [id])
    userId String

    label String
    name  String
    order Int
    value String
}

model Experience {
    id     String @id @default(uuid())
    user   User   @relation(fields: [userId], references: [id])
    userId String

    title       String
    company     String
    isCurrent   Boolean
    startDate   DateTime
    endDate     DateTime?
    description String?

    skills Skill[]
}

model Education {
    id     String @id @default(uuid())
    user   User   @relation(fields: [userId], references: [id])
    userId String

    school       String
    degree       String?
    fieldOfStudy String?
    description  String?
    isCurrent    Boolean
    startDate    DateTime
    endDate      DateTime?

    skills Skill[]
}

model PortfolioItem {
    id     String @id @default(uuid())
    user   User   @relation(fields: [userId], references: [id])
    userId String

    title       String
    description String
    order       Int
    content     Json?

    skills Skill[]

    @@unique([userId, title])
}
